部分用C++实现的高级算法,见reserver
